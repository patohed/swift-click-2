---
interface Props {
	currentPage: number;
	totalPages: number;
}

const { currentPage, totalPages } = Astro.props;

const pages = [
	{ path: '/', label: 'Hero' },
	{ path: '/about', label: 'About Us' },
	{ path: '/diferencial', label: 'Diferencial' },
	{ path: '/filosofia', label: 'Filosofía' },
	{ path: '/trabajo', label: 'Trabajo' },
	{ path: '/integracion', label: 'Integración' },
	{ path: '/infraestructura', label: 'Infraestructura' },
	{ path: '/vision', label: 'Visión' },
	{ path: '/vision-detalle', label: 'Visión Detalle' },
	{ path: '/estructura', label: 'Estructura' },
	{ path: '/contacto', label: 'Contacto' }
];

const prevPage = currentPage > 1 ? pages[currentPage - 2] : null;
const nextPage = currentPage < totalPages ? pages[currentPage] : null;
---

<div class="fixed right-2 sm:right-4 md:right-6 lg:right-8 top-[20%] sm:top-1/2 transform -translate-y-1/2 z-50 flex gap-2 sm:gap-3 md:gap-4">
	{prevPage && (
		<a 
			href={prevPage.path}
			class="nav-btn opacity-50 hover:opacity-100 transition-opacity duration-300"
			aria-label={`Página anterior: ${prevPage.label}`}
		>
			<svg class="w-10 h-10 sm:w-10 sm:h-10 md:w-12 md:h-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<circle cx="12" cy="12" r="11" stroke="#b8a9ff" stroke-width="2" fill="rgba(184, 169, 255, 0.2)"/>
				<path d="M16 12L8 12M8 12L12 8M8 12L12 16" stroke="#b8a9ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>
		</a>
	)}
	
	{!prevPage && (
		<button 
			disabled
			class="nav-btn opacity-30 cursor-not-allowed"
			aria-label="No hay página anterior"
		>
			<svg class="w-10 h-10 sm:w-10 sm:h-10 md:w-12 md:h-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<circle cx="12" cy="12" r="11" stroke="#b8a9ff" stroke-width="2" fill="rgba(184, 169, 255, 0.2)"/>
				<path d="M16 12L8 12M8 12L12 8M8 12L12 16" stroke="#b8a9ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>
		</button>
	)}

	{nextPage && (
		<a 
			href={nextPage.path}
			class="nav-btn opacity-50 hover:opacity-100 transition-opacity duration-300"
			aria-label={`Siguiente página: ${nextPage.label}`}
		>
			<svg class="w-10 h-10 sm:w-10 sm:h-10 md:w-12 md:h-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<circle cx="12" cy="12" r="11" stroke="#b8a9ff" stroke-width="2" fill="rgba(184, 169, 255, 0.2)"/>
				<path d="M8 12L16 12M16 12L12 8M16 12L12 16" stroke="#b8a9ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>
		</a>
	)}
	
	{!nextPage && (
		<button 
			disabled
			class="nav-btn opacity-30 cursor-not-allowed"
			aria-label="No hay siguiente página"
		>
			<svg class="w-10 h-10 sm:w-10 sm:h-10 md:w-12 md:h-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<circle cx="12" cy="12" r="11" stroke="#b8a9ff" stroke-width="2" fill="rgba(184, 169, 255, 0.2)"/>
				<path d="M8 12L16 12M16 12L12 8M16 12L12 16" stroke="#b8a9ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			</svg>
		</button>
	)}
</div>

<style>
	.nav-btn {
		transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		transform-style: preserve-3d;
	}

	.nav-btn:hover:not(:disabled) {
		transform: scale(1.1) translateZ(10px);
		filter: drop-shadow(0 0 20px rgba(184, 169, 255, 0.6));
	}

	.nav-btn:active:not(:disabled) {
		transform: scale(0.95);
	}
</style>

<script>
	// Efecto de ripple al hacer clic y tracking de dirección
	document.addEventListener('astro:page-load', () => {
		const navButtons = document.querySelectorAll('.nav-btn');
		
		navButtons.forEach(btn => {
			btn.addEventListener('click', (e) => {
				const event = e as MouseEvent;
				const link = btn as HTMLAnchorElement;
				
				// Determinar dirección basada en la URL
				if (link.href) {
					const currentPath = window.location.pathname;
					const targetPath = new URL(link.href).pathname;
					
					const paths = ['/', '/about', '/diferencial', '/filosofia', '/trabajo', '/integracion'];
					const currentIndex = paths.indexOf(currentPath);
					const targetIndex = paths.indexOf(targetPath);
					
					if (targetIndex < currentIndex) {
						document.documentElement.dataset.direction = 'back';
					} else {
						delete document.documentElement.dataset.direction;
					}
				}
				
				createRipple(event.clientX, event.clientY);
				createTransitionParticles(link.href ? 1 : -1);
			});
		});

		function createRipple(x: number, y: number) {
			const ripple = document.createElement('div');
			ripple.style.cssText = `
				position: fixed;
				left: ${x}px;
				top: ${y}px;
				width: 0;
				height: 0;
				border-radius: 50%;
				background: radial-gradient(circle, rgba(184, 169, 255, 0.4) 0%, transparent 70%);
				pointer-events: none;
				z-index: 999;
				animation: rippleEffect 1s ease-out forwards;
			`;

			const keyframes = `
				@keyframes rippleEffect {
					0% {
						width: 0;
						height: 0;
						margin-left: 0;
						margin-top: 0;
						opacity: 1;
					}
					100% {
						width: 500px;
						height: 500px;
						margin-left: -250px;
						margin-top: -250px;
						opacity: 0;
					}
				}
			`;

			const styleSheet = document.createElement('style');
			styleSheet.textContent = keyframes;
			document.head.appendChild(styleSheet);
			document.body.appendChild(ripple);

			setTimeout(() => ripple.remove(), 1000);
		}

		function createTransitionParticles(direction: number) {
			const particleContainer = document.createElement('div');
			particleContainer.style.cssText = `
				position: fixed;
				top: 0;
				left: 0;
				width: 100vw;
				height: 100vh;
				pointer-events: none;
				z-index: 100;
			`;
			document.body.appendChild(particleContainer);

			for (let i = 0; i < 15; i++) {
				const particle = document.createElement('div');
				const size = Math.random() * 5 + 2;
				const startX = direction > 0 ? -50 : window.innerWidth + 50;
				const endX = direction > 0 ? window.innerWidth + 50 : -50;
				const y = Math.random() * window.innerHeight;
				const duration = Math.random() * 600 + 400;

				particle.style.cssText = `
					position: absolute;
					width: ${size}px;
					height: ${size}px;
					background: radial-gradient(circle, rgba(184, 169, 255, 0.8) 0%, rgba(157, 141, 241, 0.3) 100%);
					border-radius: 50%;
					left: ${startX}px;
					top: ${y}px;
					box-shadow: 0 0 15px rgba(184, 169, 255, 0.5);
					animation: particleFloat${i} ${duration}ms ease-out forwards;
				`;

				const keyframes = `
					@keyframes particleFloat${i} {
						0% {
							transform: translateX(0) scale(0);
							opacity: 0;
						}
						20% {
							opacity: 1;
							transform: translateX(${(endX - startX) * 0.2}px) scale(1);
						}
						100% {
							transform: translateX(${endX - startX}px) scale(0);
							opacity: 0;
						}
					}
				`;

				const styleSheet = document.createElement('style');
				styleSheet.textContent = keyframes;
				document.head.appendChild(styleSheet);
				particleContainer.appendChild(particle);
			}

			setTimeout(() => particleContainer.remove(), 1000);
		}
	});
</script>
