---
interface Props {
	currentPage: number;
	totalPages: number;
}

const { currentPage, totalPages } = Astro.props;

const pages = [
	{ path: '/', label: 'Home' },
	{ path: '/diferencial', label: 'Diferencial' },
	{ path: '/filosofia', label: 'Filosofía' },
	{ path: '/infraestructura', label: 'Infraestructura' },
	{ path: '/integracion', label: 'Integración' },
	{ path: '/estructura', label: 'Estructura' },
	{ path: '/vision-detalle', label: 'Visión' },
	{ path: '/contacto', label: 'Contacto' },
	{ path: '/formulario', label: 'Formulario' }
];

const prevPage = currentPage > 1 ? pages[currentPage - 2] : null;
const nextPage = currentPage < totalPages ? pages[currentPage] : null;
---

<div class="fixed top-4 sm:top-6 md:top-8 left-1/2 transform -translate-x-1/2 z-50 flex gap-4 sm:gap-6 pointer-events-none">
	<!-- Botón anterior (izquierda) -->
	<div class="pointer-events-auto">
		{prevPage && (
			<a 
				href={prevPage.path}
				class="nav-btn group"
				aria-label={`Página anterior: ${prevPage.label}`}
			>
				<svg class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M15 18L9 12L15 6" stroke="#b8a9ff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
				</svg>
			</a>
		)}
		
		{!prevPage && (
			<button 
				disabled
				class="nav-btn-disabled"
				aria-label="No hay página anterior"
			>
				<svg class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M15 18L9 12L15 6" stroke="#b8a9ff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
				</svg>
			</button>
		)}
	</div>

	<!-- Botón siguiente (derecha) -->
	<div class="pointer-events-auto">
		{nextPage && (
			<a 
				href={nextPage.path}
				class="nav-btn group"
				aria-label={`Siguiente página: ${nextPage.label}`}
			>
				<svg class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M9 18L15 12L9 6" stroke="#b8a9ff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
				</svg>
			</a>
		)}
		
		{!nextPage && (
			<button 
				disabled
				class="nav-btn-disabled"
				aria-label="No hay siguiente página"
			>
				<svg class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M9 18L15 12L9 6" stroke="#b8a9ff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
				</svg>
			</button>
		)}
	</div>
</div>

<style>
	.nav-btn {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 40px;
		height: 40px;
		border-radius: 50%;
		background: rgba(184, 169, 255, 0.1);
		backdrop-filter: blur(10px);
		border: 1px solid rgba(184, 169, 255, 0.2);
		transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		opacity: 0.6;
	}

	.nav-btn:hover {
		opacity: 1;
		background: rgba(184, 169, 255, 0.15);
		border-color: rgba(184, 169, 255, 0.4);
		transform: translateX(2px);
		box-shadow: 0 0 20px rgba(184, 169, 255, 0.3);
	}

	.nav-btn:active {
		transform: scale(0.95);
	}

	.nav-btn svg {
		transition: transform 0.3s ease;
	}

	.nav-btn:hover svg {
		transform: translateX(2px);
	}

	.nav-btn-disabled {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 40px;
		height: 40px;
		border-radius: 50%;
		background: rgba(184, 169, 255, 0.05);
		border: 1px solid rgba(184, 169, 255, 0.1);
		opacity: 0.3;
		cursor: not-allowed;
	}

	@media (min-width: 640px) {
		.nav-btn, .nav-btn-disabled {
			width: 44px;
			height: 44px;
		}
	}

	@media (min-width: 768px) {
		.nav-btn, .nav-btn-disabled {
			width: 48px;
			height: 48px;
		}
	}
</style>

<script>
	// Efecto de ripple al hacer clic y tracking de dirección
	document.addEventListener('astro:page-load', () => {
		const navButtons = document.querySelectorAll('.nav-btn');
		
		navButtons.forEach(btn => {
			btn.addEventListener('click', (e) => {
				const event = e as MouseEvent;
				const link = btn as HTMLAnchorElement;
				
				// Determinar dirección basada en la URL
				if (link.href) {
					const currentPath = window.location.pathname;
					const targetPath = new URL(link.href).pathname;
					
					const paths = ['/', '/about', '/diferencial', '/filosofia', '/trabajo', '/integracion'];
					const currentIndex = paths.indexOf(currentPath);
					const targetIndex = paths.indexOf(targetPath);
					
					if (targetIndex < currentIndex) {
						document.documentElement.dataset.direction = 'back';
					} else {
						delete document.documentElement.dataset.direction;
					}
				}
				
				createRipple(event.clientX, event.clientY);
				createTransitionParticles(link.href ? 1 : -1);
			});
		});

		function createRipple(x: number, y: number) {
			const ripple = document.createElement('div');
			ripple.style.cssText = `
				position: fixed;
				left: ${x}px;
				top: ${y}px;
				width: 0;
				height: 0;
				border-radius: 50%;
				background: radial-gradient(circle, rgba(184, 169, 255, 0.4) 0%, transparent 70%);
				pointer-events: none;
				z-index: 999;
				animation: rippleEffect 1s ease-out forwards;
			`;

			const keyframes = `
				@keyframes rippleEffect {
					0% {
						width: 0;
						height: 0;
						margin-left: 0;
						margin-top: 0;
						opacity: 1;
					}
					100% {
						width: 500px;
						height: 500px;
						margin-left: -250px;
						margin-top: -250px;
						opacity: 0;
					}
				}
			`;

			const styleSheet = document.createElement('style');
			styleSheet.textContent = keyframes;
			document.head.appendChild(styleSheet);
			document.body.appendChild(ripple);

			setTimeout(() => ripple.remove(), 1000);
		}

		function createTransitionParticles(direction: number) {
			const particleContainer = document.createElement('div');
			particleContainer.style.cssText = `
				position: fixed;
				top: 0;
				left: 0;
				width: 100vw;
				height: 100vh;
				pointer-events: none;
				z-index: 100;
			`;
			document.body.appendChild(particleContainer);

			for (let i = 0; i < 15; i++) {
				const particle = document.createElement('div');
				const size = Math.random() * 5 + 2;
				const startX = direction > 0 ? -50 : window.innerWidth + 50;
				const endX = direction > 0 ? window.innerWidth + 50 : -50;
				const y = Math.random() * window.innerHeight;
				const duration = Math.random() * 600 + 400;

				particle.style.cssText = `
					position: absolute;
					width: ${size}px;
					height: ${size}px;
					background: radial-gradient(circle, rgba(184, 169, 255, 0.8) 0%, rgba(157, 141, 241, 0.3) 100%);
					border-radius: 50%;
					left: ${startX}px;
					top: ${y}px;
					box-shadow: 0 0 15px rgba(184, 169, 255, 0.5);
					animation: particleFloat${i} ${duration}ms ease-out forwards;
				`;

				const keyframes = `
					@keyframes particleFloat${i} {
						0% {
							transform: translateX(0) scale(0);
							opacity: 0;
						}
						20% {
							opacity: 1;
							transform: translateX(${(endX - startX) * 0.2}px) scale(1);
						}
						100% {
							transform: translateX(${endX - startX}px) scale(0);
							opacity: 0;
						}
					}
				`;

				const styleSheet = document.createElement('style');
				styleSheet.textContent = keyframes;
				document.head.appendChild(styleSheet);
				particleContainer.appendChild(particle);
			}

			setTimeout(() => particleContainer.remove(), 1000);
		}
	});
</script>
